<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="date" content="2016-02-21" />

<title>Tools for Data Manipulation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Tools for Data Manipulation</h1>
<h4 class="date"><em>2016-02-21</em></h4>
</div>


<p><a href="https://travis-ci.org/wahani/dat"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MCIgaGVpZ2h0PSIyMCI+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4Mj0iMCIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2JiYiIgc3RvcC1vcGFjaXR5PSIuMSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1vcGFjaXR5PSIuMSIvPjwvbGluZWFyR3JhZGllbnQ+PHJlY3Qgcng9IjMiIHdpZHRoPSI5MCIgaGVpZ2h0PSIyMCIgZmlsbD0iIzU1NSIvPjxyZWN0IHJ4PSIzIiB4PSIzNyIgd2lkdGg9IjUzIiBoZWlnaHQ9IjIwIiBmaWxsPSIjNGMxIi8+PHBhdGggZmlsbD0iIzRjMSIgZD0iTTM3IDBoNHYyMGgtNHoiLz48cmVjdCByeD0iMyIgd2lkdGg9IjkwIiBoZWlnaHQ9IjIwIiBmaWxsPSJ1cmwoI2EpIi8+PGcgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkRlamFWdSBTYW5zLFZlcmRhbmEsR2VuZXZhLHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiPjx0ZXh0IHg9IjE5LjUiIHk9IjE1IiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIj5idWlsZDwvdGV4dD48dGV4dCB4PSIxOS41IiB5PSIxNCI+YnVpbGQ8L3RleHQ+PHRleHQgeD0iNjIuNSIgeT0iMTUiIGZpbGw9IiMwMTAxMDEiIGZpbGwtb3BhY2l0eT0iLjMiPnBhc3Npbmc8L3RleHQ+PHRleHQgeD0iNjIuNSIgeT0iMTQiPnBhc3Npbmc8L3RleHQ+PC9nPjwvc3ZnPg==" alt="Travis-CI Build Status" /></a> <a href="https://codecov.io/github/wahani/dat?branch=master"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NiIgaGVpZ2h0PSIyMCI+PGxpbmVhckdyYWRpZW50IGlkPSJiIiB4Mj0iMCIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2JiYiIgc3RvcC1vcGFjaXR5PSIuMSIgLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3Atb3BhY2l0eT0iLjEiIC8+PC9saW5lYXJHcmFkaWVudD48bWFzayBpZD0iYSI+PHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9IjIwIiByeD0iMyIgZmlsbD0iI2ZmZiIgLz48L21hc2s+PGcgbWFzaz0idXJsKCNhKSI+PHBhdGggZmlsbD0iIzU1NSIgZD0iTTAgMGg2MHYyMEgweiIgLz48cGF0aCBmaWxsPSIjNGMxIiBkPSJNNjAgMGgzNnYyMEg2MHoiIC8+PHBhdGggZmlsbD0idXJsKCNiKSIgZD0iTTAgMGg5NnYyMEgweiIgLz48L2c+PGcgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkRlamFWdSBTYW5zLFZlcmRhbmEsR2VuZXZhLHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiPjx0ZXh0IHg9IjMwIiB5PSIxNSIgZmlsbD0iIzAxMDEwMSIgZmlsbC1vcGFjaXR5PSIuMyI+Q29kZWNvdjwvdGV4dD48dGV4dCB4PSIzMCIgeT0iMTQiPkNvZGVjb3Y8L3RleHQ+PHRleHQgeD0iNzciIHk9IjE1IiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIj45OSU8L3RleHQ+PHRleHQgeD0iNzciIHk9IjE0Ij45OSU8L3RleHQ+PC9nPjwvc3ZnPg==" alt="codecov.io" /></a> <a href="http://cran.r-project.org/package=dat"><img src="data:image/svg+xml; charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDQiIGhlaWdodD0iMjAiPgogIDxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDI9IjAiIHkyPSIxMDAlIj4KICAgIDxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2JiYiIgc3RvcC1vcGFjaXR5PSIuMSIvPgogICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9Ii4xIi8+CiAgPC9saW5lYXJHcmFkaWVudD4KICA8bWFzayBpZD0iYSI+CiAgICA8cmVjdCB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjIwIiByeD0iMyIgZmlsbD0iI2ZmZiIvPgogIDwvbWFzaz4KICA8ZyBtYXNrPSJ1cmwoI2EpIj4KICAgIDxwYXRoIGZpbGw9IiM1NTUiIGQ9Ik0wIDBoNDN2MjBIMHoiLz4KICAgIDxwYXRoIGZpbGw9IiNlMDVkNDQiIGQ9Ik00MyAwaDEyN3YyMEg0M3oiLz4KICAgIDxwYXRoIGZpbGw9InVybCgjYikiIGQ9Ik0wIDBoMTQ0djIwSDB6Ii8+CiAgPC9nPgogIDxnIGZpbGw9IiNmZmYiIHRleHQtYW5jaG9yPSJtaWRkbGUiCiAgICAgZm9udC1mYW1pbHk9IkRlamFWdSBTYW5zLFZlcmRhbmEsR2VuZXZhLHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiPgogICAgPHRleHQgeD0iMjEuNSIgeT0iMTUiIGZpbGw9IiMwMTAxMDEiIGZpbGwtb3BhY2l0eT0iLjMiPgogICAgICBDUkFOCiAgICA8L3RleHQ+CiAgICA8dGV4dCB4PSIyMS41IiB5PSIxNCI+CiAgICAgIENSQU4KICAgIDwvdGV4dD4KICAgIDx0ZXh0IHg9IjkyLjUiIHk9IjE1IiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIj4KICAgICAgbm90IHB1Ymxpc2hlZAogICAgPC90ZXh0PgogICAgPHRleHQgeD0iOTIuNSIgeT0iMTQiPgogICAgICBub3QgcHVibGlzaGVkCiAgICA8L3RleHQ+CiAgPC9nPgo8L3N2Zz4=" alt="CRAN_Status_Badge" /></a> <a href="http://www.r-pkg.org/pkg/dat"><img src="data:image/svg+xml; charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDkiIGhlaWdodD0iMjAiPgogIDxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDI9IjAiIHkyPSIxMDAlIj4KICAgIDxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2JiYiIgc3RvcC1vcGFjaXR5PSIuMSIvPgogICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9Ii4xIi8+CiAgPC9saW5lYXJHcmFkaWVudD4KICA8bWFzayBpZD0iYSI+CiAgICA8cmVjdCB3aWR0aD0iMTQ5IiBoZWlnaHQ9IjIwIiByeD0iMyIgZmlsbD0iI2ZmZiIvPgogIDwvbWFzaz4KICA8ZyBtYXNrPSJ1cmwoI2EpIj48cGF0aCBmaWxsPSIjNTU1IiBkPSJNMCAwaDcwdjIwSDB6Ii8+CiAgICA8cGF0aCBmaWxsPSIjNGMxIiBkPSJNNzAgMGg3OXYyMEg3MHoiLz4KICAgIDxwYXRoIGZpbGw9InVybCgjYikiIGQ9Ik0wIDBoMTQ5djIwSDB6Ii8+CiAgPC9nPgogIDxnIGZpbGw9IiNmZmYiIHRleHQtYW5jaG9yPSJtaWRkbGUiCiAgICAgZm9udC1mYW1pbHk9IkRlamFWdSBTYW5zLFZlcmRhbmEsR2VuZXZhLHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiPgogICAgPHRleHQgeD0iMzYiIHk9IjE1IiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIj4KICAgICAgZG93bmxvYWRzCiAgICA8L3RleHQ+CiAgICA8dGV4dCB4PSIzNiIgeT0iMTQiPgogICAgICBkb3dubG9hZHMKICAgIDwvdGV4dD4KICAgIDx0ZXh0IHg9IjEwOC41IiB5PSIxNSIgZmlsbD0iIzAxMDEwMSIgZmlsbC1vcGFjaXR5PSIuMyI+CiAgICAgIDAvbW9udGgKICAgIDwvdGV4dD4KICAgIDx0ZXh0IHg9IjEwOC41IiB5PSIxNCI+CiAgICAgIDAvbW9udGgKICAgIDwvdGV4dD4KICA8L2c+Cjwvc3ZnPg==" alt="Downloads" /></a></p>
<p>An implementation of common higher order functions (map, extract) and a link to dplyr for common transformations on data frames to work around non standard evaluation by default.</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">&quot;wahani/dat&quot;</span>)</code></pre></div>
</div>
<div id="why-should-you-care" class="section level2">
<h2>Why should you care?</h2>
<ul>
<li>You probably have to rewrite all your dplyr / data.table code once you put it inside a package. I.e. working around non standard evaluation or find another way to satisfy R CMD check. And you don’t like that.</li>
<li>dplyr is not respecting the class of the object it operates on; the class attribute changes on-the-fly.</li>
<li>Neither dplyr nor data.table is playing nice with S4, but you really, really want a S4 <em>data.table</em> or <em>tbl_df</em>.</li>
<li>You like currying as in rlist and purrr.</li>
<li>We work together and you have to understand code I wrote.</li>
</ul>
</div>
<div id="map" class="section level2">
<h2>map</h2>
<p>What we can do with map:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dat)
<span class="kw">map</span>(<span class="dv">1</span>:<span class="dv">3</span>, ~<span class="st"> </span>.^<span class="dv">2</span>) <span class="co"># lapply</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 4
## 
## [[3]]
## [1] 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">flatmap</span>(<span class="dv">1</span>:<span class="dv">3</span>, ~<span class="st"> </span>.^<span class="dv">2</span>) <span class="co"># lapply + unlist</span></code></pre></div>
<pre><code>## [1] 1 4 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">flatmap</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="kw">numeric</span>(<span class="dv">1</span>) :<span class="st"> </span>x ~<span class="st"> </span>x^<span class="dv">2</span>) <span class="co"># lapply + unlist + type check</span></code></pre></div>
<pre><code>## [1] 1 4 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map</span>(<span class="kw">ML</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">4</span>:<span class="dv">1</span>), integer :<span class="st"> </span><span class="kw">f</span>(x, y) ~<span class="st"> </span><span class="kw">rep</span>(x, y)) <span class="co"># mapply + check return type</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1 1 1 1
## 
## [[2]]
## [1] 2 2 2
## 
## [[3]]
## [1] 3 3
## 
## [[4]]
## [1] 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map</span>(<span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">4</span>:<span class="dv">1</span>), <span class="dv">2</span>:<span class="dv">3</span>) <span class="co"># subsetting on lists</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2 3
## 
## [[2]]
## [1] 3 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map</span>(<span class="kw">ML</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">11</span>:<span class="dv">13</span>), c) <span class="co"># zip</span></code></pre></div>
<pre><code>## [[1]]
## [1]  1 11
## 
## [[2]]
## [1]  2 12
## 
## [[3]]
## [1]  3 13</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map</span>(<span class="kw">ML</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">11</span>:<span class="dv">13</span>), c) %&gt;%<span class="st"> </span>
<span class="st">  </span>{ <span class="kw">map</span>(<span class="kw">do.call</span>(ML, .), c) } <span class="co"># unzip</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1 2 3
## 
## [[2]]
## [1] 11 12 13</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">map</span>(dat, x ~<span class="st"> </span>x +<span class="st"> </span><span class="dv">1</span>, is.numeric) <span class="co"># only operates on numeric cols</span></code></pre></div>
<pre><code>##   x y
## 1 2</code></pre>
</div>
<div id="extract" class="section level2">
<h2>extract</h2>
<p>Sum all even numbers from 1 to 10:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">is.even &lt;-<span class="st"> </span>function(x) (x %%<span class="st"> </span><span class="dv">2</span>) ==<span class="st"> </span><span class="dv">0</span>
<span class="kw">sum</span>((<span class="dv">1</span>:<span class="dv">10</span>)[<span class="kw">is.even</span>(<span class="dv">1</span>:<span class="dv">10</span>)])</code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span>:<span class="dv">10</span> %&gt;%<span class="st"> </span><span class="kw">extract</span>(~<span class="st"> </span>. %%<span class="st"> </span><span class="dv">2</span> ==<span class="st"> </span><span class="dv">0</span>) %&gt;%<span class="st"> </span>sum</code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span>:<span class="dv">10</span> %&gt;%<span class="st"> </span><span class="kw">extract</span>(is.even) %&gt;%<span class="st"> </span>sum</code></pre></div>
<pre><code>## [1] 30</code></pre>
<p>Find all factors of 15:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">factors &lt;-<span class="st"> </span>function(a, <span class="dt">b =</span> <span class="dv">1</span>:a) b[a %%<span class="st"> </span>b ==<span class="st"> </span><span class="dv">0</span>]
<span class="kw">factors</span>(<span class="dv">15</span>)</code></pre></div>
<pre><code>## [1]  1  3  5 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">extract</span>(<span class="dv">1</span>:<span class="dv">15</span>, ~<span class="st"> </span><span class="dv">15</span> %%<span class="st"> </span>. ==<span class="st"> </span><span class="dv">0</span>)</code></pre></div>
<pre><code>## [1]  1  3  5 15</code></pre>
<p>Find all relative prime numbers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gcd &lt;-<span class="st"> </span>function(a, b) {
  .gcd &lt;-<span class="st"> </span>function(a, b) if (b ==<span class="st"> </span><span class="dv">0</span>) a else <span class="kw">Recall</span>(b, a %%<span class="st"> </span>b)
  <span class="kw">map</span>(<span class="kw">ML</span>(a, b), .gcd) %&gt;%<span class="st"> </span>unlist
}

<span class="kw">extract</span>(<span class="dv">1</span>:<span class="dv">10</span>, x ~<span class="st"> </span><span class="kw">gcd</span>(x, <span class="dv">10</span>) ==<span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 1 3 7 9</code></pre>
<p>Find real prime numbers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">isPrime &lt;-<span class="st"> </span>function(n) {
  .isPrime &lt;-<span class="st"> </span>function(n) {
    iter &lt;-<span class="st"> </span>function(i) {
      if (i *<span class="st"> </span>i &gt;<span class="st"> </span>n) <span class="ot">TRUE</span>
      else if (n %%<span class="st"> </span>i ==<span class="st"> </span><span class="dv">0</span> ||<span class="st"> </span>n %%<span class="st"> </span>(i +<span class="st"> </span><span class="dv">2</span>) ==<span class="st"> </span><span class="dv">0</span>) <span class="ot">FALSE</span>
      else <span class="kw">Recall</span>(i +<span class="st"> </span><span class="dv">6</span>)
    }
    if (n &lt;=<span class="st"> </span><span class="dv">1</span>) <span class="ot">FALSE</span>
    else if (n &lt;=<span class="st"> </span><span class="dv">3</span>) <span class="ot">TRUE</span>
    else if (n %%<span class="st"> </span><span class="dv">2</span> ==<span class="st"> </span><span class="dv">0</span> ||<span class="st"> </span>n %%<span class="st"> </span><span class="dv">3</span> ==<span class="st"> </span><span class="dv">0</span>) <span class="ot">FALSE</span>
    else <span class="kw">iter</span>(<span class="dv">5</span>)
  }
  <span class="kw">flatmap</span>(n, <span class="kw">logical</span>(<span class="dv">1</span>) :<span class="st"> </span>x ~<span class="st"> </span><span class="kw">.isPrime</span>(x))
}

<span class="kw">extract</span>(<span class="dv">1</span>:<span class="dv">10</span>, isPrime)</code></pre></div>
<pre><code>## [1] 2 3 5 7</code></pre>
</div>
<div id="data-frame" class="section level2">
<h2>Data Frame</h2>
<p>I took the examples from the introductory vignette of dplyr. Things that are not supported:</p>
<ul>
<li>rename</li>
<li>distinct</li>
<li>transmute</li>
</ul>
<p>But you still work with data frames. So you can go back or mix in dplyr features when you need them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nycflights13)
<span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">do.call</span>(DataFrame, flights)
<span class="kw">str</span>(dat)</code></pre></div>
<pre><code>## Classes 'DataFrame', 'tbl_df', 'tbl' and 'data.frame':   336776 obs. of  16 variables:
##  $ year     : int  2013 2013 2013 2013 2013 2013 2013 2013 2013 2013 ...
##  $ month    : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ day      : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ dep_time : int  517 533 542 544 554 554 555 557 557 558 ...
##  $ dep_delay: num  2 4 2 -1 -6 -4 -5 -3 -3 -2 ...
##  $ arr_time : int  830 850 923 1004 812 740 913 709 838 753 ...
##  $ arr_delay: num  11 20 33 -18 -25 12 19 -14 -8 8 ...
##  $ carrier  : chr  &quot;UA&quot; &quot;UA&quot; &quot;AA&quot; &quot;B6&quot; ...
##  $ tailnum  : chr  &quot;N14228&quot; &quot;N24211&quot; &quot;N619AA&quot; &quot;N804JB&quot; ...
##  $ flight   : int  1545 1714 1141 725 461 1696 507 5708 79 301 ...
##  $ origin   : chr  &quot;EWR&quot; &quot;LGA&quot; &quot;JFK&quot; &quot;JFK&quot; ...
##  $ dest     : chr  &quot;IAH&quot; &quot;IAH&quot; &quot;MIA&quot; &quot;BQN&quot; ...
##  $ air_time : num  227 227 160 183 116 150 158 53 140 138 ...
##  $ distance : num  1400 1416 1089 1576 762 ...
##  $ hour     : num  5 5 5 5 5 5 5 5 5 5 ...
##  $ minute   : num  17 33 42 44 54 54 55 57 57 58 ...</code></pre>
<div id="filter" class="section level3">
<h3>Filter</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, month ==<span class="st"> </span><span class="dv">1</span>, day ==<span class="st"> </span><span class="dv">1</span>) <span class="co"># dplyr</span>
dat[~<span class="st"> </span>month ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>day ==<span class="st"> </span><span class="dv">1</span>]          <span class="co"># #1</span>
<span class="kw">mutar</span>(dat, ~<span class="st"> </span>month ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>day ==<span class="st"> </span><span class="dv">1</span>)   <span class="co"># #2</span>

<span class="kw">slice</span>(flights, <span class="dv">1</span>:<span class="dv">10</span>)                  <span class="co"># dplyr</span>
dat[~<span class="dv">1</span>:<span class="dv">10</span>]                            <span class="co"># #1</span>
dat %&gt;%<span class="st"> </span><span class="kw">mutar</span>(~<span class="dv">1</span>:<span class="dv">10</span>)                  <span class="co"># #2</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat[<span class="dv">1</span>:<span class="dv">10</span>, ]                           <span class="co"># standard things</span></code></pre></div>
<pre><code>## Source: local data frame [10 x 16]
## 
##     year month   day dep_time dep_delay arr_time arr_delay carrier tailnum
##    (int) (int) (int)    (int)     (dbl)    (int)     (dbl)   (chr)   (chr)
## 1   2013     1     1      517         2      830        11      UA  N14228
## 2   2013     1     1      533         4      850        20      UA  N24211
## 3   2013     1     1      542         2      923        33      AA  N619AA
## 4   2013     1     1      544        -1     1004       -18      B6  N804JB
## 5   2013     1     1      554        -6      812       -25      DL  N668DN
## 6   2013     1     1      554        -4      740        12      UA  N39463
## 7   2013     1     1      555        -5      913        19      B6  N516JB
## 8   2013     1     1      557        -3      709       -14      EV  N829AS
## 9   2013     1     1      557        -3      838        -8      B6  N593JB
## 10  2013     1     1      558        -2      753         8      AA  N3ALAA
## Variables not shown: flight (int), origin (chr), dest (chr), air_time
##   (dbl), distance (dbl), hour (dbl), minute (dbl)</code></pre>
</div>
<div id="sorting" class="section level3">
<h3>Sorting</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">arrange</span>(flights, year, month, day)    <span class="co"># dplyr</span>
dat[~<span class="kw">order</span>(year, month, day)]         <span class="co"># #1</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat %&gt;%<span class="st"> </span><span class="kw">mutar</span>(~<span class="kw">order</span>(year, month, day)) <span class="co"># #2</span></code></pre></div>
<pre><code>## Source: local data frame [336,776 x 16]
## 
##     year month   day dep_time dep_delay arr_time arr_delay carrier tailnum
##    (int) (int) (int)    (int)     (dbl)    (int)     (dbl)   (chr)   (chr)
## 1   2013     1     1      517         2      830        11      UA  N14228
## 2   2013     1     1      533         4      850        20      UA  N24211
## 3   2013     1     1      542         2      923        33      AA  N619AA
## 4   2013     1     1      544        -1     1004       -18      B6  N804JB
## 5   2013     1     1      554        -6      812       -25      DL  N668DN
## 6   2013     1     1      554        -4      740        12      UA  N39463
## 7   2013     1     1      555        -5      913        19      B6  N516JB
## 8   2013     1     1      557        -3      709       -14      EV  N829AS
## 9   2013     1     1      557        -3      838        -8      B6  N593JB
## 10  2013     1     1      558        -2      753         8      AA  N3ALAA
## ..   ...   ...   ...      ...       ...      ...       ...     ...     ...
## Variables not shown: flight (int), origin (chr), dest (chr), air_time
##   (dbl), distance (dbl), hour (dbl), minute (dbl)</code></pre>
</div>
<div id="select-cols" class="section level3">
<h3>Select cols</h3>
<p>You can use characters and logicals to select cols of a <em>DataFrame</em>. Using numeric values is not supported; it is error prone and I have spent too many hours of my life debugging code where I relied on positions in a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(flights, year, month, day)       <span class="co"># dplyr </span>
<span class="kw">select</span>(flights, year:day)               <span class="co"># dplyr</span>

<span class="co"># characters are passed into dplyr::select_:</span>
dat %&gt;%
<span class="st">  </span><span class="kw">mutar</span>(<span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">mutar</span>(<span class="st">&quot;year:day&quot;</span>)

dat[<span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>)][<span class="st">&quot;year:day&quot;</span>]</code></pre></div>
<p>You can also pass in a function which checks if you want to select a column, e.g. select all numeric cols:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat[is.numeric] <span class="co"># or mutar(dat, is.numeric)</span></code></pre></div>
<pre><code>## Source: local data frame [336,776 x 12]
## 
##     year month   day dep_time dep_delay arr_time arr_delay flight air_time
##    (int) (int) (int)    (int)     (dbl)    (int)     (dbl)  (int)    (dbl)
## 1   2013     1     1      517         2      830        11   1545      227
## 2   2013     1     1      533         4      850        20   1714      227
## 3   2013     1     1      542         2      923        33   1141      160
## 4   2013     1     1      544        -1     1004       -18    725      183
## 5   2013     1     1      554        -6      812       -25    461      116
## 6   2013     1     1      554        -4      740        12   1696      150
## 7   2013     1     1      555        -5      913        19    507      158
## 8   2013     1     1      557        -3      709       -14   5708       53
## 9   2013     1     1      557        -3      838        -8     79      140
## 10  2013     1     1      558        -2      753         8    301      138
## ..   ...   ...   ...      ...       ...      ...       ...    ...      ...
## Variables not shown: distance (dbl), hour (dbl), minute (dbl)</code></pre>
<p>Or select all cols with missing values in them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat[function(x) <span class="kw">any</span>(<span class="kw">is.na</span>(x))]</code></pre></div>
</div>
<div id="mutate" class="section level3">
<h3>Mutate</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gain =</span> arr_delay -<span class="st"> </span>dep_delay,
         <span class="dt">speed =</span> distance /<span class="st"> </span>air_time *<span class="st"> </span><span class="dv">60</span>)

dat[gain ~<span class="st"> </span>arr_delay -<span class="st"> </span>dep_delay,
    speed ~<span class="st"> </span>distance /<span class="st"> </span>air_time *<span class="st"> </span><span class="dv">60</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat %&gt;%
<span class="st">  </span><span class="kw">mutar</span>(gain ~<span class="st"> </span>arr_delay -<span class="st"> </span>dep_delay,
        speed ~<span class="st"> </span>distance /<span class="st"> </span>air_time *<span class="st"> </span><span class="dv">60</span>) %&gt;%
<span class="st">  </span><span class="kw">mutar</span>(<span class="st">&quot;^gain|speed$&quot;</span>) <span class="co"># I assume a regex if the character begins with '^'</span></code></pre></div>
<pre><code>## Source: local data frame [336,776 x 2]
## 
##     gain    speed
##    (dbl)    (dbl)
## 1      9 370.0441
## 2     16 374.2731
## 3     31 408.3750
## 4    -17 516.7213
## 5    -19 394.1379
## 6     16 287.6000
## 7     24 404.4304
## 8    -11 259.2453
## 9     -5 404.5714
## 10    10 318.6957
## ..   ...      ...</code></pre>
</div>
<div id="summarise" class="section level3">
<h3>Summarise</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">group_by</span>(flights, month) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">delay =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))

dat[delay ~<span class="st"> </span><span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
    by =<span class="st"> &quot;month&quot;</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mutar</span>(dat, 
      delay ~<span class="st"> </span><span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
      <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>)</code></pre></div>
<pre><code>## Source: local data frame [12 x 2]
## 
##    month     delay
##    (int)     (dbl)
## 1      1 10.036665
## 2      2 10.816843
## 3      3 13.227076
## 4      4 13.938038
## 5      5 12.986859
## 6      6 20.846332
## 7      7 21.727787
## 8      8 12.611040
## 9      9  6.722476
## 10    10  6.243988
## 11    11  5.435362
## 12    12 16.576688</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dplyr:</span>
delay1 &lt;-<span class="st"> </span>flights %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(tailnum) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">count =</span> <span class="kw">n</span>(),
    <span class="dt">dist =</span> <span class="kw">mean</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
  ) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(count &gt;<span class="st"> </span><span class="dv">20</span>, dist &lt;<span class="st"> </span><span class="dv">2000</span>)

<span class="co"># dat #1:</span>
delay2 &lt;-<span class="st"> </span>dat[
  count ~<span class="st"> </span><span class="kw">n</span>(),
  dist ~<span class="st"> </span><span class="kw">mean</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  delay ~<span class="st"> </span><span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  by =<span class="st"> &quot;tailnum&quot;</span>
  ] %&gt;%
<span class="st">  </span>.[~count &gt;<span class="st"> </span><span class="dv">20</span> &amp;<span class="st"> </span>dist &lt;<span class="st"> </span><span class="dv">2000</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dat #2:</span>
dat %&gt;%
<span class="st">  </span><span class="kw">mutar</span>(count ~<span class="st"> </span><span class="kw">n</span>(),
        dist ~<span class="st"> </span><span class="kw">mean</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
        delay ~<span class="st"> </span><span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
        <span class="dt">by =</span> <span class="st">&quot;tailnum&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">mutar</span>(~count &gt;<span class="st"> </span><span class="dv">20</span> &amp;<span class="st"> </span>dist &lt;<span class="st"> </span><span class="dv">2000</span>)</code></pre></div>
<pre><code>## Source: local data frame [2,962 x 4]
## 
##    tailnum count     dist      delay
##      (chr) (int)    (dbl)      (dbl)
## 1           2512 710.2576        NaN
## 2   N0EGMQ   371 676.1887  9.9829545
## 3   N10156   153 757.9477 12.7172414
## 4   N102UW    48 535.8750  2.9375000
## 5   N103US    46 535.1957 -6.9347826
## 6   N104UW    47 535.2553  1.8043478
## 7   N10575   289 519.7024 20.6914498
## 8   N105UW    45 524.8444 -0.2666667
## 9   N107US    41 528.7073 -5.7317073
## 10  N108UW    60 534.5000 -1.2500000
## ..     ...   ...      ...        ...</code></pre>
</div>
<div id="split-apply-combine" class="section level3">
<h3>Split-apply-combine</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The naive split-apply-combine</span>
<span class="kw">map</span>(dat, mutar, <span class="kw">By</span>(<span class="st">&quot;month&quot;</span>), count ~<span class="st"> </span><span class="kw">n</span>()) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutar</span>(<span class="dv">27003</span>:<span class="dv">27006</span>, <span class="dt">j =</span> <span class="kw">c</span>(<span class="st">&quot;month&quot;</span>, <span class="st">&quot;count&quot;</span>))</code></pre></div>
<pre><code>## Source: local data frame [4 x 2]
## 
##   month count
##   (int) (int)
## 1     1 27004
## 2     1 27004
## 3     2 24951
## 4     2 24951</code></pre>
</div>
<div id="mixing-dplyr-and-mutar" class="section level3">
<h3>Mixing dplyr and mutar</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(tailnum) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">count =</span> <span class="kw">n</span>(),
    <span class="dt">dist =</span> <span class="kw">mean</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
  ) %&gt;%
<span class="st">  </span><span class="kw">mutar</span>(~count &gt;<span class="st"> </span><span class="dv">20</span> &amp;<span class="st"> </span>dist &lt;<span class="st"> </span><span class="dv">2000</span>)</code></pre></div>
<pre><code>## Source: local data frame [2,962 x 4]
## 
##    tailnum count     dist      delay
##      (chr) (int)    (dbl)      (dbl)
## 1           2512 710.2576        NaN
## 2   N0EGMQ   371 676.1887  9.9829545
## 3   N10156   153 757.9477 12.7172414
## 4   N102UW    48 535.8750  2.9375000
## 5   N103US    46 535.1957 -6.9347826
## 6   N104UW    47 535.2553  1.8043478
## 7   N10575   289 519.7024 20.6914498
## 8   N105UW    45 524.8444 -0.2666667
## 9   N107US    41 528.7073 -5.7317073
## 10  N108UW    60 534.5000 -1.2500000
## ..     ...   ...      ...        ...</code></pre>
</div>
<div id="example-with-s4-and-data.table" class="section level3">
<h3>Example with S4 and data.table</h3>
<p>Let’s define a S4 class inheriting from data.table and do something with it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)</code></pre></div>
<pre><code>## 
## Attaching package: 'data.table'</code></pre>
<pre><code>## The following objects are masked from 'package:dplyr':
## 
##     between, last</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setOldClass</span>(<span class="kw">c</span>(<span class="st">&quot;data.table&quot;</span>, <span class="st">&quot;data.frame&quot;</span>))

<span class="kw">setClass</span>(<span class="st">&quot;DataTable&quot;</span>, <span class="st">&quot;data.table&quot;</span>)

DataTable &lt;-<span class="st"> </span>function(...) {
  <span class="kw">new</span>(<span class="st">&quot;DataTable&quot;</span>, data.table::<span class="kw">data.table</span>(...))
}

<span class="kw">setMethod</span>(<span class="st">&quot;[&quot;</span>, <span class="st">&quot;DataTable&quot;</span>, mutar)</code></pre></div>
<pre><code>## [1] &quot;[&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
dat &lt;-<span class="st"> </span><span class="kw">DataTable</span>(<span class="dt">id =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span>:<span class="dv">2</span>], <span class="dt">each =</span> <span class="dv">10</span>), <span class="dt">x =</span> <span class="dv">101</span>:<span class="dv">120</span>, <span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">20</span>))
dat[<span class="dv">1</span>:<span class="dv">2</span>, ]</code></pre></div>
<pre><code>## Object of class &quot;DataTable&quot;
##    id   x          y
## 1:  a 101 -0.6264538
## 2:  a 102  0.1836433</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutar</span>(~<span class="dv">1</span>:<span class="dv">2</span>, y ~<span class="st"> </span><span class="kw">runif</span>(<span class="dv">2</span>))</code></pre></div>
<pre><code>## Object of class &quot;DataTable&quot;
##    id   x         y
## 1:  a 101 0.8209463
## 2:  a 102 0.6470602</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat %&gt;%
<span class="st">  </span><span class="kw">mutar</span>(sumOfX ~<span class="st"> </span><span class="kw">sum</span>(x), <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## Object of class &quot;DataTable&quot;
##    id sumOfX
## 1:  a   1055
## 2:  b   1155</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map</span>(dat, mutar, <span class="kw">By</span>(<span class="st">&quot;id&quot;</span>), sumOfX ~<span class="st"> </span><span class="kw">sum</span>(x))[~<span class="dv">1</span>:<span class="dv">2</span>]</code></pre></div>
<pre><code>## Object of class &quot;DataTable&quot;
##    id   x          y sumOfX
## 1:  a 101 -0.6264538   1055
## 2:  a 102  0.1836433   1055</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map</span>(dat, dt ~<span class="st"> </span><span class="kw">DataTable</span>(<span class="dt">sumOfX =</span> <span class="kw">sum</span>(dt$x)), <span class="kw">By</span>(<span class="st">&quot;id&quot;</span>))</code></pre></div>
<pre><code>## Object of class &quot;DataTable&quot;
##    sumOfX
## 1:   1055
## 2:   1155</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
